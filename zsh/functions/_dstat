#compdef dstat _dstat

_list_cpu () {
    local _cpus
    _cpus=(total 0 3)
    compadd "$@" -a _cpus
}

_list_disk () {
    local _disks
    _disks=(total hda) 
    compadd "$@" -a _disks
}

_dstat () {
	local curcontext="$curcontext" state line expl ret=1
	local dstat_version=`dstat --version | head -n 1 | awk '{print $2}'`
#[delay [count]]
	_arguments -C \
		'(-)--help[print help information]' \
		'(- *)--version[print client version information]' \
		'(-c --cpu)'{-c,--cpu}'[enable cpu stats]' \
		'(-C)-C[include cpu0, cpu3 and total]:cpu list:_list_cpu' \
        '(-d --disk)'{-d,--disk}'[enable disk stats]' \
        '(-D)-D[include hda and total]:disk list:_list_disk' \
        '(-g --page)'{-g,--page}'[enable page stats]' \
        '(-i --int)'{-i,--int}'[enable interrupt stats]' \
        '(-I)-I[5,eth2 include int5 and interrupt used by eth2]' \
        '(-l --load)'{-l,--load}'[enable load stats]' \
		'1: :->cmds' \
		'*:: :->args' && ret=0
#  -m, --mem              enable memory stats
#  -n, --net              enable network stats
#     -N eth1,total          include eth1 and total
#  -p, --proc             enable process stats
#  -r, --io               enable io stats (I/O requests completed)
#  -s, --swap             enable swap stats
#     -S swap1,total         include swap1 and total
#  -t, --time             enable time/date output
#  -T, --epoch            enable time counter (seconds since epoch)
#  -y, --sys              enable system stats
#
#  --aio                  enable aio stats
#  --fs, --filesystem     enable fs stats
#  --ipc                  enable ipc stats
#  --lock                 enable lock stats
#  --raw                  enable raw stats
#  --socket               enable socket stats
#  --tcp                  enable tcp stats
#  --udp                  enable udp stats
#  --unix                 enable unix stats
#  --vm                   enable vm stats
#
#  --plugin-name          enable plugins by plugin name (see manual)
#  --list                 list all available plugins
#
#  -a, --all              equals -cdngy (default)
#  -f, --full             automatically expand -C, -D, -I, -N and -S lists
#  -v, --vmstat           equals -pmgdsc -D total
#
#  --float                force float values on screen
#  --integer              force integer values on screen
#
#  --bw, --blackonwhite   change colors for white background terminal
#  --nocolor              disable colors (implies --noupdate)
#  --noheaders            disable repetitive headers
#  --noupdate             disable intermediate updates
#  --output file          write CSV output to file
#
#delay is the delay in seconds between each update (default: 1)
#count is the number of updates to display before exiting (default: unlimited)
#
}

_dstat "$@"
